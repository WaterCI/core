<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="817px" preserveAspectRatio="none" style="width:1062px;height:817px;background:#FFFFFF;" version="1.1" viewBox="0 0 1062 817" width="1062px" zoomAndPan="magnify"><defs/><g><rect height="29.0679" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="158" x="448.25" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="148" x="453.25" y="29.9659">Core Communications</text><rect height="357.7662" style="stroke:#000000;stroke-width:1.5;fill:none;" width="651.5" x="394" y="390.49"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="135" x2="135" y1="96.1358" y2="765.2562"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="421" x2="421" y1="96.1358" y2="765.2562"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="786" x2="786" y1="96.1358" y2="765.2562"/><rect fill="#E2E2F0" height="33.0679" style="stroke:#181818;stroke-width:0.5;" width="77" x="99" y="58.0679"/><rect fill="#E2E2F0" height="33.0679" style="stroke:#181818;stroke-width:0.5;" width="77" x="95" y="62.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="102" y="84.0339">incoming</text><rect fill="#E2E2F0" height="33.0679" style="stroke:#181818;stroke-width:0.5;" width="77" x="99" y="764.2562"/><rect fill="#E2E2F0" height="33.0679" style="stroke:#181818;stroke-width:0.5;" width="77" x="95" y="768.2562"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="102" y="790.2221">incoming</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="404" y="92.0339">core</text><ellipse cx="421.5" cy="61.0679" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="417.5,49.0679,423.5,44.0679,421.5,49.0679,423.5,54.0679,417.5,49.0679" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="404" y="779.2221">core</text><ellipse cx="421.5" cy="799.3241" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="417.5,787.3241,423.5,782.3241,421.5,787.3241,423.5,792.3241,417.5,787.3241" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#E2E2F0" height="33.0679" style="stroke:#181818;stroke-width:0.5;" width="79" x="749" y="58.0679"/><rect fill="#E2E2F0" height="33.0679" style="stroke:#181818;stroke-width:0.5;" width="79" x="745" y="62.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="752" y="84.0339">executors</text><rect fill="#E2E2F0" height="33.0679" style="stroke:#181818;stroke-width:0.5;" width="79" x="749" y="764.2562"/><rect fill="#E2E2F0" height="33.0679" style="stroke:#181818;stroke-width:0.5;" width="79" x="745" y="768.2562"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="752" y="790.2221">executors</text><polygon fill="#181818" points="432.5,137.6949,422.5,141.6949,432.5,145.6949,428.5,141.6949" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="426.5" x2="785.5" y1="141.6949" y2="141.6949"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="438.5" y="135.8859">TCP connect</text><path d="M791,111.1358 L791,156.1358 L995,156.1358 L995,121.1358 L985,111.1358 L791,111.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M985,111.1358 L985,121.1358 L995,121.1358 L985,111.1358 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="797" y="130.0328">All executor/core</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="797" y="147.7389">communication is via MsgPack</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1055.5" x="0" y="183.4009"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1055.5" y1="183.4009" y2="183.4009"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1055.5" y1="186.4009" y2="186.4009"/><rect fill="#EEEEEE" height="25.706" style="stroke:#000000;stroke-width:2.0;" width="146" x="454.75" y="171.5479"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="129" x="460.75" y="189.4449">Executor Registration</text><polygon fill="#181818" points="432.5,226.9599,422.5,230.9599,432.5,234.9599,428.5,230.9599" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="426.5" x2="785.5" y1="230.9599" y2="230.9599"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="438.5" y="225.1509">ExecutorMessage::ExecutorRegister</text><polygon fill="#181818" points="774.5,258.6659,784.5,262.6659,774.5,266.6659,778.5,262.6659" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="421.5" x2="780.5" y1="262.6659" y2="262.6659"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307" x="428.5" y="256.8569">ExecutorMessage::ExecutorRegisterResponse(uuid)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1055.5" x="0" y="292.5189"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1055.5" y1="292.5189" y2="292.5189"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1055.5" y1="295.5189" y2="295.5189"/><rect fill="#EEEEEE" height="25.706" style="stroke:#000000;stroke-width:2.0;" width="192" x="431.75" y="280.6659"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175" x="437.75" y="298.5629">Build Request from VCS client</text><polygon fill="#181818" points="409.5,371.49,419.5,375.49,409.5,379.49,413.5,375.49" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="135.5" x2="415.5" y1="375.49" y2="375.49"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="142.5" y="334.2689">IncomingMessage::BuildRequestFromRepo(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="148.5" y="351.975">BuildRequestFromRepo</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="142.5" y="369.681">)</text><path d="M5,327.2249 L5,372.2249 L131,372.2249 L131,337.2249 L121,327.2249 L5,327.2249 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M121,327.2249 L121,337.2249 L131,337.2249 L121,327.2249 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="11" y="346.122">all incoming/core</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="11" y="363.828">msgs are in YAML</text><path d="M426,336.0779 L426,363.0779 L684,363.0779 L684,346.0779 L674,336.0779 L426,336.0779 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M674,336.0779 L674,346.0779 L684,346.0779 L674,336.0779 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="432" y="354.975">Build request is stored in internal queue</text><path d="M394,390.49 L577,390.49 L577,400.196 L567,410.196 L394,410.196 L394,390.49 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="357.7662" style="stroke:#000000;stroke-width:1.5;" width="651.5" x="394" y="390.49"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138" x="409" y="405.387">Executor Build Request</text><polygon fill="#181818" points="774.5,432.902,784.5,436.902,774.5,440.902,778.5,436.902" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="421.5" x2="780.5" y1="436.902" y2="436.902"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240" x="428.5" y="431.093">ExecutorMessage::ExecutorStatusQuery</text><path d="M791,415.196 L791,442.196 L955,442.196 L955,425.196 L945,415.196 L791,415.196 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M945,415.196 L945,425.196 L955,425.196 L945,415.196 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="797" y="434.093">ensures executor status</text><polygon fill="#181818" points="432.5,470.608,422.5,474.608,432.5,478.608,428.5,474.608" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="426.5" x2="785.5" y1="474.608" y2="474.608"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="438.5" y="468.799">ExecutorMessage::ExecutorStatusResponse</text><path d="M791,452.902 L791,479.902 L963,479.902 L963,462.902 L953,452.902 L791,452.902 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M953,452.902 L953,462.902 L963,462.902 L953,452.902 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="797" y="471.799">send build request over…</text><polygon fill="#181818" points="774.5,505.314,784.5,509.314,774.5,513.314,778.5,509.314" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="421.5" x2="780.5" y1="509.314" y2="509.314"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341" x="428.5" y="503.505">ExecutorMessage::BuildRequest(BuildRequestFromRepo)</text><polygon fill="#181818" points="774.5,548.8731,784.5,552.8731,774.5,556.8731,778.5,552.8731" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="421.5" x2="780.5" y1="552.8731" y2="552.8731"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240" x="428.5" y="547.0641">ExecutorMessage::ExecutorStatusQuery</text><path d="M791,522.314 L791,567.314 L1030,567.314 L1030,532.314 L1020,522.314 L791,522.314 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1020,522.314 L1020,532.314 L1030,532.314 L1020,522.314 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="797" y="541.2111">ask status again,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="797" y="558.9171">in case executor can build more stuff</text><polygon fill="#181818" points="432.5,592.4321,422.5,596.4321,432.5,600.4321,428.5,596.4321" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="426.5" x2="785.5" y1="596.4321" y2="596.4321"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="438.5" y="590.6231">ExecutorMessage::ExecutorStatusResponse</text><polygon fill="#FEFFDD" points="705,609.4321,867,609.4321,877,621.4321,867,634.4321,705,634.4321,695,621.4321,705,609.4321" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="707" y="627.3291">Executes the build request</text><line style="stroke:#181818;stroke-width:1.0;" x1="786.5" x2="828.5" y1="663.8441" y2="663.8441"/><line style="stroke:#181818;stroke-width:1.0;" x1="828.5" x2="828.5" y1="663.8441" y2="676.8441"/><line style="stroke:#181818;stroke-width:1.0;" x1="787.5" x2="828.5" y1="676.8441" y2="676.8441"/><polygon fill="#181818" points="797.5,672.8441,787.5,676.8441,797.5,680.8441,793.5,676.8441" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="793.5" y="658.0351">//executes the build request…</text><polygon fill="#181818" points="432.5,704.5501,422.5,708.5501,432.5,712.5501,428.5,708.5501" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="426.5" x2="785.5" y1="708.5501" y2="708.5501"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304" x="438.5" y="702.7411">ExecutorMessage::JobBuildResult(JobBuildResult) 1</text><polygon fill="#181818" points="432.5,736.2562,422.5,740.2562,432.5,744.2562,428.5,740.2562" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="426.5" x2="785.5" y1="740.2562" y2="740.2562"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305" x="438.5" y="734.4472">ExecutorMessage::JobBuildResult(JobBuildResult) n</text><!--MD5=[3d9bd461807513292faaf73087a3d45e]
@startuml
title Core Communications
collections incoming
control core
collections executors
core <- - executors: TCP connect
note right: All executor/core\ncommunication is via MsgPack
== Executor Registration ==
core <- executors: ExecutorMessage::ExecutorRegister
core -> executors: ExecutorMessage::ExecutorRegisterResponse(uuid)
== Build Request from VCS client ==
incoming -> core: IncomingMessage::BuildRequestFromRepo(\n  BuildRequestFromRepo\n)
note left: all incoming/core\nmsgs are in YAML
note right: Build request is stored in internal queue
group Executor Build Request
core -> executors: ExecutorMessage::ExecutorStatusQuery
note right: ensures executor status
core <- executors: ExecutorMessage::ExecutorStatusResponse
note right: send build request over…
core -> executors: ExecutorMessage::BuildRequest(BuildRequestFromRepo)
core -> executors: ExecutorMessage::ExecutorStatusQuery
note right: ask status again,\nin case executor can build more stuff
core <- executors: ExecutorMessage::ExecutorStatusResponse
hnote over executors: Executes the build request
executors -> executors: //executes the build request…
core <- executors: ExecutorMessage::JobBuildResult(JobBuildResult) 1
core <- executors: ExecutorMessage::JobBuildResult(JobBuildResult) n
end
@enduml

PlantUML version 1.2022.5(Sat Apr 30 12:55:52 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>